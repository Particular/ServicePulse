<div class="row">

    <ul class="breadcrumb breadcrumb-fixed">
        <li>
            <a href="#/dashboard">Home</a>
        </li>
        <li>
            Failed Messages
        </li>
    </ul>

</div>


<div class="container">



    <section name="message_groups">

        <div class="row">
            <div class="col-md-12" ng-show="vm.exceptionGroups.length === 0 && !vm.loadingData">


                <h5>message failures</h5>

                <div class="row box">
                    <div class="col-md-12">
                        <div class="row">

                            <div class="col-sm-12">
                                <div class="row box-header">
                                    <div class="col-md-12">
                                        <p class="lead hard-wrap">There are currently no grouped message failures</p>
                                        <p>&nbsp;</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="col-md-12" ng-show="vm.exceptionGroups.length > 0">
                <h5>
                    showing {{vm.exceptionGroups.length}} failed messages groups. Messages are grouped by exception type and exception line of code.
                </h5>
                <div class="row box wf-{{group.workflow_state.status}} repeat-modify" ng-repeat="group in vm.exceptionGroups">
                    <div class="col-md-12">
                        <div class="row" ng-show="group.workflow_state.status !=='ready'">
                            <div class="check col-md-1">

                            </div>
                            <div class="col-sm-9">
                                <div class="row box-header">
                                    <div class="col-md-12">
                                        <p class="lead">Processing Group {{group.title}}</p>
                                        <p>It can take some time for these messages to be processed by your system. Please be patient. </p>
                                        <p>If you leave this screen messages my appear as if they have not been processed when you return. </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2">

                            </div>
                        </div>
                        <div class="row" ng-show="group.workflow_state.status ==='ready'">
                            <div class="check col-md-1">

                            </div>
                            <div class="col-sm-9">
                                <div class="row box-header">
                                    <div class="col-md-12" ng-click="vm.viewExceptionGroup(group)">
                                        <p class="lead"> {{group.title}}</p>
                                        <p>
                                            There are currently {{group.count}} message<span ng-show="group.count >1">s</span> in this group
                                        </p>
                                        <p>
                                            The most recent failure occured <sp-moment date="{{group.last}}"></sp-moment> with the first failure occuring <sp-moment date="{{group.first}}"></sp-moment>.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <button type="button" class="btn btn-link btn-sm pull-right  hidden-sm-down" tooltip="View messages in this Group" ng-click="vm.viewExceptionGroup(group)" ng-disabled="group.count == 0">
                                    <i>View Messages</i>
                                </button>
                                <button type="button" class="btn btn-link btn-sm  pull-right" tooltip="Retry messages in this Group" ng-click="vm.retryExceptionGroup(group)" ng-disabled="group.count == 0 || group.workflow_state.status !== 'ready'">
                                    <i>Retry Group</i>
                                </button>
                                <button type="button" class="btn btn-link btn-sm pull-right" tooltip="Archive messages in this Group" confirm-click="vm.archiveExceptionGroup(group)" ng-disabled="group.count == 0 || group.workflow_state.status !== 'ready'" confirm-message="Are you sure you want to archive this group of messages? If you do, they will not be available for Retry.">
                                    <i>Archive Group</i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </section>

    <section name="global_message_management">


        <div class="row">
            <div class="col-md-12">


                <h5>global message failure management</h5>

                <div class="row alert-danger box box-danger">
                    <div class="col-md-12">
                        <div class="row">

                            <div class="col-sm-12">
                                <div class="row box-header">
                                    <div class="col-md-12">
                                        <p class="pull-right">
                                            <button class="btn btn-danger" type="button" ng-show="vm.exceptionGroups.length > 0" confirm-message="Are you really sure you want to retry all failed messages?" confirm-click="retryAll()" tooltip="All failed messages will be Retried"><i class="fa fa-refresh white"></i> Retry All Failed Messages</button>
                                            <button class="btn btn-default" type="button" ng-click="vm.viewExceptionGroup(vm.allFailedMessagesGroup)" tooltip="Review all Messages"><i class="fa fa-envelope"></i> View All Failed Messages</button>
                                        </p>
                                        <p>
                                        </p><h4>Warning!</h4> Retrying all messages can be a time consuming operation. Take care when doing this.
                                        <p></p>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>

    </section>
    <p>
        <br>
    </p>

</div>
